<script src="https://unpkg.com/gsap/dist/gsap.min.js"></script>
<script src="https://unpkg.com/gsap/dist/ScrollTrigger.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/smooth-scroll@16/dist/smooth-scroll.polyfills.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r152/three.min.js"></script>
<script>
  gsap.registerPlugin(ScrollTrigger)
  document.querySelectorAll("section").forEach(section => {
    gsap.to(section, {
      scrollTrigger: {
        trigger: section,
        start: "top 80%",
        toggleActions: "play none none none"
      },
      opacity: 1,
      y: 0,
      duration: 0.8,
      ease: "power2.out"
    })
  })

  const cursor = document.getElementById("cursor")
  document.addEventListener("mousemove", e => {
    cursor.style.left = e.clientX + "px"
    cursor.style.top = e.clientY + "px"
  })

  const navLinks = document.querySelectorAll("nav a")
  navLinks.forEach(link => {
    link.addEventListener("mouseenter", () => {
      cursor.style.transform = "translate(-50%,-50%) scale(1.5)"
    })
    link.addEventListener("mouseleave", () => {
      cursor.style.transform = "translate(-50%,-50%) scale(1)"
    })
  })

  const canvas = document.getElementById("weatherCanvas")
  const ctx = canvas.getContext("2d")
  canvas.width = window.innerWidth
  canvas.height = window.innerHeight

  let particles = []
  let rainMode = true

  function Particle() {
    this.x = Math.random() * canvas.width
    this.y = Math.random() * canvas.height
    this.vy = rainMode ? Math.random() * 4 + 4 : Math.random() * 1 + 0.5
    this.size = rainMode ? Math.random() * 1 + 1 : Math.random() * 2 + 1
  }

  Particle.prototype.update = function () {
    this.y += this.vy
    if (this.y > canvas.height) {
      this.y = 0
      this.x = Math.random() * canvas.width
    }
  }

  Particle.prototype.draw = function () {
    ctx.beginPath()
    ctx.fillStyle = rainMode ? "rgba(0,173,238,0.5)" : "#fff"
    ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2)
    ctx.fill()
  }

  function initParticles() {
    particles = []
    for (let i = 0; i < 300; i++) particles.push(new Particle())
  }

  function animate() {
    ctx.clearRect(0, 0, canvas.width, canvas.height)
    for (let i = 0; i < particles.length; i++) {
      particles[i].update()
      particles[i].draw()
    }
    requestAnimationFrame(animate)
  }

  initParticles()
  animate()

  document.getElementById("toggleBtn").addEventListener("click", () => {
    rainMode = !rainMode
    document.body.className = rainMode ? "rain" : "snow"
    initParticles()
  })

  const gfxImages = document.querySelectorAll(".gfx-gallery img")
  gfxImages.forEach(img => {
    img.style.transition = "transform .3s ease"
    img.addEventListener("mousemove", e => {
      const bounds = img.getBoundingClientRect()
      const x = ((e.clientX - bounds.left) / bounds.width - 0.5) * 20
      const y = ((e.clientY - bounds.top) / bounds.height - 0.5) * 20
      img.style.transform = `rotateX(${-y}deg) rotateY(${x}deg) scale(1.05)`
    })
    img.addEventListener("mouseleave", () => {
      img.style.transform = "rotateX(0deg) rotateY(0deg) scale(1)"
    })
  })
</script>
<script src="script.js"></script>
